{% extends "base.html" %}

{% block head %}
  {{ super() }}
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <link href="{{ url_for('static', filename='css/dashboard.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="d-flex">
  <!-- Sidebar -->
  <nav class="sidebar">
    <div class="px-4 mb-4">
      <h3 class="text-xl font-semibold">ðŸŒ± Eco Dashboard</h3>
    </div>
    <a href="{{ url_for('dash_bp.dashboard') }}"><i class="bi bi-house me-2"></i> Dashboard</a>
    <a href="{{ url_for('dash_bp.rewards') }}"><i class="bi bi-gift me-2"></i> Rewards</a>
    <a href="{{ url_for('auth.reset_password') }}" ><i class="bi bi-person me-2"></i> Reset Password</a>
    <a href="{{ url_for('dash_bp.logout') }}"><i class="bi bi-box-arrow-right me-2"></i> Logout</a>
  </nav>

  <!-- Main Content -->
  <div class="main-content w-100">
    <header class="header mb-5 text-center">
      <h1 class="text-3xl font-bold">Welcome, {{ username|capitalize }} ðŸ‘‹</h1>
      <p class="text-lg opacity-80">Track your sustainable impact and compare with the community</p>
    </header>

    <div class="container-fluid">
      <div class="row g-4">
        <!-- Eco Points Card -->
        <div class="col-lg-6 col-md-6">
          <div class="eco-card p-4 text-center">
            <h4 class="font-semibold text-lg mb-2"><i class="bi bi-star-fill text-yellow-400 me-2"></i> Eco Reward Points</h4>
            <p class="point-count">{{ eco_points|int }}</p>
            <p class="hint">Earn points for walking and cycling â€” the greener your travel, the higher you score!</p>
          </div>
        </div>

        <!-- Redeem Points Card -->
        <div class="col-lg-6 col-md-6">
          <div class="eco-card p-4 text-center">
            <h4 class="font-semibold text-lg mb-2"><i class="bi bi-gift text-blue-500 me-2"></i> Redeem Eco Points</h4>
            <p class="hint mb-3">Use your points to claim rewards and contribute to a greener planet!</p>
            <a href="{{ url_for('dash_bp.rewards') }}" class="btn btn-primary">Explore Rewards</a>
          </div>
        </div>

        <!-- Chart Section -->
        <div class="col-12">
          <div class="chart-container">
            <div class="row mb-4">
              <div class="col-md-6">
                <label class="font-semibold mb-2">Data Type:</label>
                <select id="dataSelection" onchange="updateGraph()" class="form-select">
                  <option value="steps">Walking Steps</option>
                  <option value="cycling">Cycling Distance</option>
                </select>
              </div>
              <div class="col-md-6">
                <label class="font-semibold mb-2">View Range:</label>
                <select id="rangeSelection" onchange="updateGraph()" class="form-select">
                  <option value="all">All</option>
                  <option value="7">Last 7 Days</option>
                  <option value="30">Last 30 Days</option>
                </select>
              </div>
            </div>
            <div style="height: 400px;">
              <canvas id="mainChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

    <script
  data-walking-data='{{ walking_data|tojson }}'
  data-cycling-data='{{ cycling_data|tojson }}'
  data-avg-data='{{ avg_data|tojson }}'
  data-avg-cycling-data='{{ avg_cycling_data|tojson }}'
></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}